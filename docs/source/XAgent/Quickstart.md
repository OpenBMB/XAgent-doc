# Installation

## 1. Preliminary Requirements

### 1.1 Basic Requirements

- **[Docker Compose](https://docs.docker.com/compose/install/)**
- **Python >= 3.10** (Optional, If you use terminal.)

### 1.2 Clone the XAgent repo

```bash
git clone https://github.com/OpenBMB/XAgent.git
cd XAgent
python -m venv .venv && source .venv/bin/activate ## [Optional] Create virtual environment and activate it
pip install -r requirements.txt 
```

### 1.3 Configure XAgent

Fill in `assets/config.yml` with your `api_keys`. 
```bash
vim assets/config.yml
```
1. Make sure at least one OpenAI key is provided in `assets/config.yml` to access OpenAI API.
  - `gpt-4-32k` is highly recommended; `gpt-4` is also OK for most simple tasks.
  - At least one `gpt-3.5-turbo-16k` API key should be provided as a backup model.
  - Do not rely on `gpt-3.5-turbo` due to the minimal context length. Do not try to run XAgent with that.
2. You can change the `config_file` path to somewhere other than `asset/config.yml` for `XAgentServer` by modifying the `CONFIG_FILE` value in `.env` file and restart the docker container.
3. **Remove all the unfamiliar arguments such as `organization` under `api_keys` from the template `config.yml`** unless you really know about them! After that your `api_keys` configure may become as simple as
    ```yaml
     api_keys:
       gpt-3.5-turbo-16k:
         - api_key: sk-xxxxxx
           model: gpt-3.5-turbo-16k
       gpt-4:
         - api_key: sk-xxxxxx
           model: gpt-4
       gpt-4-32k:
         - api_key: sk-xxxxxx
           model: gpt-4
    ```
4. If you are confused about where those kwargs such as `api_base` or `engine` come from, See [Azure OpenAI Docs](https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/chatgpt?pivots=programming-language-chat-completions&tabs=python-new) for details. They work with Azure OpenAI Service only and **should** be safely removed if your agents are not using Azure OpenAI Service.

### 1.4 Build and Run ToolServer

You can build ToolServer container simply by running:
```bash
docker-compose up --build
```
ToolServer is where XAgent's action takes place. It is a docker container that provides a safe environment for XAgent to run. (If changes have been made to the configuration, this command also need to be re-run.)


## 2. Run XAgent with GUI or terminal

You can either run XAgent in terminal or with GUI.

### Run XAgent with terminal

```bash 
python run.py --task "put your task here" --model "gpt-4" --config_file "assets/config.yml"
```
1. You can use the argument `--upload_files` to select the initial files you want to submit to XAgent.

2. The local workspace for your XAgent is in `XAgent/XAgentServer/local_workspace`, where you can find all the files generated by XAgent throughout the running process. 

3. After execution, the entire `workspace` in `ToolServerNode` will be copied to `running_records` for your convenience.

4. Besides, in `running_records`, you can find all the intermediate steps information, e.g., task statuses, LLM's input-output pairs, used tools, etc.

5. You can load from a record to reproduce a former run, just by setting `record_dir` in config(default to `Null`). The record is a system-level recording tied to the code version of XAgent. All running-config、query、code execution statuses (including errors)、server behavior will be documented.

6. We have removed all sensitive information (including API keys) from the record so you can safely share it with others. In the near future, we will introduce more granular sharing options highlighting the contributions of humans during execution.

### Run XAgent with GUI

```bash
## run nginx in docker
docker exec XAgent-Server systemctl start nginx
```
Start the docker container.
You will see the XAgent Server listening on port `8090`.
You could visit `http://localhost:5173` to interact with XAgent by using web UI.

